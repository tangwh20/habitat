import gzip
import json

data_path = "/home/tangwenhao/Workspace/habitat/data/datasets/R2R_VLNCE_v1-3_preprocessed"
split = "train"

with gzip.open(f"{data_path}/{split}/{split}.json.gz", "rt") as f:
    data = json.load(f)

with gzip.open(f"{data_path}/{split}/{split}_gt.json.gz", "rt") as f:
    gt = json.load(f)

"""
data: Dict = {
    "episodes": (length 10819) List[Episode]
    "instruction_vocab": Dict = {
        "word_list": (length 2504) List[str]
        "word2idx_dict": (length 2504) Dict[str, int]
        "stoi": TODO (seems same as word2idx_dict)
        "itos": TODO (seems same as word_list)
        "num_vocab": int = 2504
        ...
    }
}

gt: (length 10819) Dict[id(from '1' to '10819'), Episode_GT]

Episode example (Episode 1): 
{
    'episode_id': 1, 
    'trajectory_id': 4, 
    'scene_id': 'mp3d/7y3sRwLe3Va/7y3sRwLe3Va.glb', 
    'start_position': [-16.267200469970703, 0.1518409252166748, 0.7207760214805603], 
    'start_rotation': [-0.0, 0.7071067811865476, -0.0, -0.7071067811865475], 
    'info': {'geodesic_distance': 6.425291538238525}, 
    'goals': [{
        'position': [-12.337400436401367, 0.1518409252166748, 4.213699817657471], 
        'radius': 3.0
    }], 
    'instruction': {
        'instruction_text': 'Go around the right side of the center unit and stop by the right side doorway with the dining table and mirror in it. ', 
        'instruction_tokens': [982, 141, 2202, 1819, 1961, 1472, 2202, 417, 2324, 103, 2104, 372, 2202, 1819, 1961, 709, 2457, 2202, 660, 2159, 103, 1390, 1138, 1173, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    }, 
    'reference_path': [
        [-16.267200469970703, 0.1518409252166748, 0.7207760214805603], 
        [-16.284099578857422, 0.1518409252166748, 2.412369966506958], 
        [-16.154499053955078, 0.1518409252166748, 4.137710094451904], 
        [-13.90719985961914, 0.1518409252166748, 4.228209972381592], 
        [-12.337400436401367, 0.1518409252166748, 4.213699817657471]
    ]
}

Episode_GT example (Episode_GT 1):
{
    'locations': [
        [-16.267200469970703, 0.1518409252166748, 0.7207760214805603], 
        [-16.267200469970703, 0.1518409252166748, 0.9707760214805603], 
        [-16.267200469970703, 0.1518409252166748, 1.220776081085205], 
        [-16.267200469970703, 0.1518409252166748, 1.470776081085205], 
        [-16.267200469970703, 0.1518409252166748, 1.720776081085205], 
        [-16.267200469970703, 0.1518409252166748, 1.970776081085205], 
        [-16.267200469970703, 0.1518409252166748, 2.220776081085205], 
        [-16.267200469970703, 0.1518409252166748, 2.470776081085205], 
        [-16.267200469970703, 0.1518409252166748, 2.720776081085205], 
        [-16.267200469970703, 0.1518409252166748, 2.970776081085205], 
        [-16.267200469970703, 0.1518409252166748, 3.220776081085205], 
        [-16.267200469970703, 0.1518409252166748, 3.470776081085205], 
        [-16.202495574951172, 0.1518409252166748, 3.7122576236724854], 
        [-15.961013793945312, 0.1518409252166748, 3.7769625186920166], 
        [-15.719532012939453, 0.1518409252166748, 3.841667413711548], 
        [-15.478050231933594, 0.1518409252166748, 3.906372308731079], 
        [-15.236568450927734, 0.1518409252166748, 3.9710772037506104], 
        [-14.995086669921875, 0.1518409252166748, 4.0357818603515625], 
        [-14.753604888916016, 0.1518409252166748, 4.100486755371094], 
        [-14.512123107910156, 0.1518409252166748, 4.165191650390625], 
        [-14.270641326904297, 0.1518409252166748, 4.229896545410156], 
        [-14.020641326904297, 0.1518409252166748, 4.229896545410156], 
        [-13.770641326904297, 0.1518409252166748, 4.229896545410156], 
        [-13.520641326904297, 0.1518409252166748, 4.229896545410156], 
        [-13.270641326904297, 0.1518409252166748, 4.229896545410156], 
        [-13.020641326904297, 0.1518409252166748, 4.229896545410156], 
        [-12.770641326904297, 0.1518409252166748, 4.229896545410156]
    ], 
    'actions': [3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 0], 
    'forward_steps': 26
}
"""

breakpoint()
print(data.keys())
print(gt.keys())